<!DOCTYPE html>
<html>
<head>
    <title>Altitude Monitor</title>
</head>
<body>
    <h1>Altitude</h1>
    <p id="altitude">Altitude: -- meters</p>
    <p id="feedback">~</p>
    <button id="requestPermission">Request Sensor Permission</button>

    <script>
        function startSensor() {
            if ('GeolocationSensor' in window) {
            const sensor = new GeolocationSensor({ frequency: 1000 });

                sensor.onreading = () => {
                    const altitude = sensor.altitude;
                    document.getElementById('altitude').innerText = `Altitude: ${altitude} meters`;
                };

                sensor.start();
            } else {
                document.getElementById('feedback').innerText = 'GeolocationSensor is not supported on this device.';
            }
        }

 document.getElementById('requestPermission').addEventListener('click', () => {
            if ('permissions' in navigator) {
                navigator.permissions.query({ name: 'geolocation' })
                    .then(permissionStatus => {
                        if (permissionStatus.state === 'granted') {
                            // Permission is already granted, start the sensor
                            startSensor();
                        } else if (permissionStatus.state === 'prompt') {
                            // Permission is not granted, request it
                            return permissionStatus.request();
                        } else {
                            // Permission is denied
                            document.getElementById('feedback').innerText = 'Permission for the geolocation sensor is denied.';
                        }
                    })
                    .then(permission => {
                        if (permission.state === 'granted') {
                            // Permission granted, start the sensor
                            startSensor();
                        }
                    });
            }
        });
    </script>
</body>
</html>
